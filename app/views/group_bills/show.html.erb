<div id="group_bill_page">
  <div id="main"> 
<!-- section A: holds hello user -->
    <section id="section-a">
      <div class="content-wrap">
        <h2 class="hello-user">Hello, <%=@admin.first_name.capitalize%></h2>
      </div>
    </section>    

<!-- section-B: holds item, price and user dropped icon -->
    <section id="section-b">
      <div class="recipt">
          <% @items.each do |item| %>
        <div class="item-container" id="item<%=item.id%>">
            <div class="items_users" id="item<%=item.id%>" ondrop="drop_handler(event);" ondragover="dragover_handler(event);">
            <p class="flex"><%= item.name.capitalize %></p>
            <p class="flex">$<%=item.price %></p>
          <%item.bills.each do |bill|%>
                <%bill.users.each do |user|%>
                <div class="dropped-content" id="bill<%bill.id%>" draggable="true"  ondragstart="dragstart_handler(event);"> <%=user.first_name.capitalize%><br><%=user.last_name.capitalize%>
                </div>
              </div>
                
            <% end %>
          <% end %>
        </div>
      </div>
    <%end%>
        <!-- user dropped icons -->        
        


  </div>
    </section>    
<!-- section-D: subtotal, tax, tip, TOTAL -->
    <section id="section-d">
        <div class="sub-total-price">
          <p class="sub-name">Sub total</p>
          <p class="sub-sum">$<%=@group_bill.subtotal%></p>
        </div>


        <div class="tax-price">
          <p class="tax-name">Tax</p>
          <p class="tax-sum">$<%=@group_bill.tax%></p>
        </div>

        <div class="tip-price">
          <p class="tip-name">Tip</p>
          <p class="tip-sum">$<%=@group_bill.tip%>%</p>
        </div>

        <div class="TOTAL-price">
          <p class="total-name">TOTAL</p>
          <p class="total-sum">$<%=@group_bill.total%></p>
        </div>
      </section>

      <%@bills_on_group_bill.each do |bill|%>
      <%bill.users.each do |user|%>
        <div  class="section-e" id="bill<%=bill.id%>" draggable="true" ondragstart="dragstart_handler(event);">
          <%=user.first_name.capitalize%><br><%=user.last_name.capitalize%> 
        </div>
        
      <% end %>
    <% end %>

    </main>

    <!-- footer -->
    <footer id="main-footer" class="split-pay-button">
      <div class="wrap-button">
        <a href="#section-e" class="btn">Split Bill</a>
      </div>

    </footer>




    <!-- item/receipt and price of item  -->
      <% @items.each do |item| %>
        <div class="item" id="item<%=item.id%>">
          <div class="items_users" id="item<%=item.id%>" ondrop="drop_handler(event);" ondragover="dragover_handler(event);">
            <%= item.name.capitalize %>
            $<%=item.price %>
            <%item.bills.each do |bill|%>
              <%bill.users.each do |user|%>
                <div  class="user" id="bill<%=bill.id%>" draggable="true" ondragstart="dragstart_handler(event);"> <%=user.first_name.capitalize%><br><%=user.last_name.capitalize%> </div>
              <% end %>
            <%end %>
            </div>
        </div>  
      <% end %> 

        <h2>Subtotal <%=@group_bill.subtotal%>
        <h2>Tip <%=@group_bill.tip%>

        <h2>Total <%=@group_bill.total%>
      </div>

      <div class="users_container">

      <%@bills_on_group_bill.each do |bill|%>
        <%bill.users.each do |user|%>
          <div  class="user" id="bill<%=bill.id%>" draggable="true" ondragstart="dragstart_handler(event);"> <%=user.first_name.capitalize%><br><%=user.last_name.capitalize%> </div>
        <% end %>
      <% end %>
        
      </div>
    </div>  -->


    <h2>Add Friends</h2>    
      <%= form_with(model: @bill) do |form| %>
        <%= form.hidden_field :group_bill_id, value: @group_bill.id %>
        <%= form.select(:users_ids, options_for_select(@users_to_add), { :prompt => "Please select"}, { :multiple => true, :size => 5 })%>
        <%= form.submit  "Add friends"%>
      <% end %> 

      <div id="invisible">
       <%= form_with( model: BillsItem.new) do |form| %>
        <%=form.hidden_field :group_bill_id, value: @group_bill.id %>
        <%=form.hidden_field :admin_id, value: @admin.id %>
        <%=form.text_field :list_of_bills_items, id: "array_of_data"%>
        <%= form.submit "Split"%>  <br/><br>
       <% end %>
      </div>
</div>